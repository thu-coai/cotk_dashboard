{% extends 'dashboard/base.html' %}

{% block title %}
  Show records
{% endblock %}

{% block content %}
  <div class="container">
    <div class="row">
      <div class="col-12">

        <table id="table" class="table table-striped table-bordered">
          <thead>
          <tr>
            <th>ID</th>
            <th>User</th>
            <th>Github commit</th>
            <th>Dataset</th>
            <th>Uploaded at</th>
            {% for col in extra_columns %}
              <th>{{ col }}</th>
            {% endfor %}
          </tr>
          </thead>
        </table>
      </div>
    </div>
    <hr class="my-4">
    <div class="row">
      <div class="col-12">
        <form method="get">
          <div class="form-group">
            <label for="extra_columns">Extra columns (Corresponding to keys in 'record_information', separated by commas):</label>
            <textarea name="extra_columns" id="extra_columns" class="form-control" rows="3"></textarea>
          </div>
          <button class="btn btn-outline-primary">Submit</button>
        </form>
      </div>
    </div>
  </div>
{% endblock %}

{% block script %}
  <script>
    $(document).ready(function () {
      $('#table').DataTable({
        {#searching: false,#}
        bSort: false,
        processing: true,
        serverSide: true,
        ajax: {
          url: "{% url 'records_json' %}",
          data: {
            {% if uid %}
              uid: {{ uid }}
            {% endif %}
          }
        },
        columns: [
          {
            name: 'id',
          },
          {
            name: 'user',
          },
          {
            name: 'github',
          },
          {
            name: 'dataset',
          },
          {
            name: 'uploaded_at',
          },
          {% for col in extra_columns %}
            {
              name: '{{ col|escapejs }}',
            },
          {% endfor %}

        ],
      });
    })
  </script>
{% endblock %}

{% block css %}
  <style>
    #table {
      width: 100%;
    }
  </style>
{% endblock %}